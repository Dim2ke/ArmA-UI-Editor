<DataTemplate
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:ad="http://schemas.xceed.com/wpf/xaml/avalondock"
      xmlns:SolutionUtil="clr-namespace:ArmA.Studio.SolutionUtil;assembly=ArmA-Studio"
      xmlns:p="clr-namespace:ArmA.Studio.Properties;assembly=ArmA-Studio"
      xmlns:ev="clr-namespace:ArmA.Studio.UI.Attached.Eventing;assembly=ArmA-Studio"
      mc:Ignorable="d" DataType="{x:Type SolutionUtil:Solution}">
    <TreeView ItemsSource="{Binding FilesCollection}">
        <TreeView.ContextMenu>
            <ContextMenu>
                <MenuItem Header="{x:Static p:Localization.Add}">
                    <MenuItem Header="{x:Static p:Localization.NewItem}" Icon="/ArmA-Studio;component/Resources/Pictograms/NewItem.png" Command="{Binding CmdContextMenu_Add_NewItem}"/>
                    <MenuItem Header="{x:Static p:Localization.ExistingItem}" Icon="/ArmA-Studio;component/Resources/Pictograms/AddItem.png" Command="{Binding CmdContextMenu_Add_ExistingItem}"/>
                    <MenuItem Header="{x:Static p:Localization.NewFolder}" Icon="/ArmA-Studio;component/Resources/Pictograms/Folder.png" Command="{Binding CmdContextMenu_Add_NewFolder}"/>
                </MenuItem>
            </ContextMenu>
        </TreeView.ContextMenu>
        <TreeView.ItemContainerStyle>
            <Style TargetType="TreeViewItem">
                <Setter Property="ev:MouseDoubleClick.Command" Value="{Binding CmdMouseDoubleClick}"/>
                <Setter Property="ev:MouseDoubleClick.CommandParameter" Value="{Binding}"/>
                <Setter Property="ContextMenu" Value="{Binding ContextMenu}"/>
            </Style>
        </TreeView.ItemContainerStyle>
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type SolutionUtil:SolutionFolder}" ItemsSource="{Binding Children}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0">
                        <Image.Style>
                            <Style TargetType="Image">
                                <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/Folder.png"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsExpanded, RelativeSource={RelativeSource AncestorType=TreeViewItem, Mode=FindAncestor}}" Value="True">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/FolderExpanded.png"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Image.Style>
                    </Image>
                    <TextBlock Grid.Column="1" Text="{Binding FileName}" ev:MouseLeftButtonDown.Command="{Binding CmdMouseLeftButtonDown}"/>
                </Grid>
            </HierarchicalDataTemplate>
            <DataTemplate DataType="{x:Type SolutionUtil:SolutionFile}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0">
                        <Image.Style>
                            <Style TargetType="Image">
                                <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/Document.png"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding FileName, Converter={StaticResource PathExtensionConverter}}" Value=".sqf">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/SQF.png"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding FileName, Converter={StaticResource PathExtensionConverter}}" Value=".uic">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/UI.png"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding FileName, Converter={StaticResource PathExtensionConverter}}" Value=".cpp">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/ConfigurationFile.png"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding FileName, Converter={StaticResource PathExtensionConverter}}" Value=".ext">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/ConfigurationFile.png"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding FileName, Converter={StaticResource PathExtensionConverter}}" Value=".hpp">
                                        <Setter Property="Source" Value="/ArmA-Studio;component/Resources/FileTypes/HeaderFile.png"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Image.Style>
                    </Image>
                    <TextBlock Grid.Column="1" Text="{Binding FileName}" ev:MouseLeftButtonDown.Command="{Binding CmdMouseLeftButtonDown}"/>
                </Grid>
            </DataTemplate>
        </TreeView.Resources>
    </TreeView>
</DataTemplate>